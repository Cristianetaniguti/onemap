

##' Add or Drop Markers From a Sequence
##' 
##' Creates a new sequence by adding or dropping markers from a predetermined
##' one. The markers are added in the end of the sequence.
##' 
##' 
##' @aliases add_drop add.marker drop.marker
##' @param input.seq an object of class \code{sequence}.
##' @param mrks a vector containing the markers to be added or removed from the
##' \code{sequence}.
##' @return An object of class \code{sequence}, which is a list containing the
##' following components: \item{seq.num}{a \code{vector} containing the
##' (ordered) indices of markers in the sequence, according to the input file.}
##' \item{seq.phases}{a \code{vector} with the linkage phases between markers
##' in the sequence, in corresponding positions. \code{-1} means that there are
##' no defined linkage phases.} \item{seq.rf}{a \code{vector} with the
##' recombination fractions between markers in the sequence. \code{-1} means
##' that there are no estimated recombination fractions.}
##' \item{seq.like}{log-likelihood of the corresponding linkage map.}
##' \item{data.name}{name of the object of class \code{outcross} with the raw
##' data.} \item{twopt}{name of the object of class \code{rf.2pts} with the
##' 2-point analyses.}
##' @author Marcelo Mollinari, \email{mmollina@@usp.br}
##' @keywords manip utilities
##' @examples
##' 
##' 
##' data(example.out)
##' twopt <- rf.2pts(example.out)
##' all.mark <- make.seq(twopt,"all")
##' groups <- group(all.mark)
##' (LG1 <- make.seq(groups,1))
##' (LG.aug<-add.marker(LG1, c(4,7)))
##' (LG.red<-drop.marker(LG1, c(1,2,3,5,6)))
##'  
##' 
NULL





##' Data from a full-sib family derived from two outbred parents
##' 
##' Simulated data set for an outcross, i.e., an F1 population obtained by
##' crossing two non-homozygous parents.
##' 
##' A total of 100 F1 individuals were genotyped for 30 markers.  The data
##' currently contains only genotype information (no phenotypes). It is
##' included to be used as a reference in order to understand how a data file
##' needs to be. Also, it is used for the analysis in the tutorial that comes
##' with OneMap.
##' 
##' @name example.out
##' @docType data
##' @format An object of class \code{outcross}.
##' @author Gabriel R A Margarido, \email{gramarga@@gmail.com}
##' @seealso \code{\link[onemap]{read.outcross}} for details about objects of
##' class \code{outcross}.
##' @keywords datasets
##' @examples
##' 
##' data(example.out)
##' 
##' # perform two-point analyses
##' twopts <- rf.2pts(example.out)
##' twopts
##' 
NULL





##' Simulated data from a backcross population
##' 
##' Simulated data set from a backcross population.
##' 
##' A total of 150 individuals were genotyped for 67 markers with 15\% of
##' missing data. There is one quantitative phenotype to show how to use
##' \code{onemap} output as \code{R\qtl} input.
##' 
##' @name fake.bc.onemap
##' @docType data
##' @format An object of class \code{bc.onemap}.
##' @author Marcelo Mollinari, \email{mmollina@@usp.br}
##' @seealso \code{\link[onemap]{read.mapmaker}} for details about objects of
##' class \code{bc.onemap}.
##' @keywords datasets
##' @examples
##' 
##' data(fake.bc.onemap)
##' 
##' # perform two-point analyses
##' twopts <- rf.2pts(fake.bc.onemap)
##' twopts
##' 
NULL





##' Simulated data from a F2 population
##' 
##' Simulated data set from a F2 population.
##' 
##' A total of 200 individuals were genotyped for 66 markers (36 co-dominant,
##' i.e. AA, AB or BB and 30 dominant i.e. Not AA or AA and Not BB or BB) with
##' 15\% of missing data. There is one quantitative phenotype to show how to
##' use \code{onemap} output as \code{R\qtl} and \code{QTL Cartographer} input.
##' Also, it is used for the analysis in the tutorial that comes with OneMap.
##' 
##' @name fake.f2.onemap
##' @docType data
##' @format An object of class \code{f2.onemap}.
##' @author Marcelo Mollinari, \email{mmollina@@usp.br}
##' @seealso \code{\link[onemap]{read.mapmaker}} for details about objects of
##' class \code{f2.onemap}.
##' @keywords datasets
##' @examples
##' 
##' data(fake.f2.onemap)
##' 
##' # perform two-point analyses
##' twopts <- rf.2pts(fake.f2.onemap)
##' twopts
##' 
NULL





##' Mapping functions Haldane and Kosambi
##' 
##' Functions to convert recombination fractions to distance in \code{cM}
##' (centiMorgans).
##' 
##' Haldane mapping function is defined as \deqn{d_{M} =
##' -\frac{1}{2}\ln(1-2r),}{dM = -(1/2) ln(1-2r),} for \eqn{0 \leq r \leq 0.5},
##' where \code{r} stands for the recombination fraction in \code{rcmb}.
##' Kosambi mapping function is \deqn{d_{M} = \frac{1}{4}\ln \left[
##' \frac{1+2r}{1-2r} \right],}{dM = (1/4) ln [(1+2r)/(1-2r),} for \eqn{0 \leq
##' r \leq 0.5}, where \code{r} is defined as above.
##' 
##' @aliases map_func haldane kosambi
##' @param rcmb A recombination fraction between two markers, i.e., a number
##' between \code{0} and \code{0.5}.
##' @return Both functions return a number with a distance measured in
##' \code{cM}.
##' @author Gabriel R A Margarido, \email{gramarga@@gmail.com}
##' @references Haldane, J. B. S. (1919) The combination of linkage values and
##' the calculation of distance between the loci of linked factors.
##' \emph{Journal of Genetics} 8: 299-309.
##' 
##' Kosambi, D. D. (1944) The estimation of map distance from recombination
##' values. \emph{Annuaire of Eugenetics} 12: 172-175.
##' @keywords arith
##' @examples
##' 
##'   # little difference for small recombination fractions
##'   haldane(0.05)
##'   kosambi(0.05)
##' 
##'   # greater difference as recombination fraction increases
##'   haldane(0.35)
##'   kosambi(0.35)
##' 
NULL





##' Internal onemap functions
##' 
##' Functions from \pkg{onemap} not to be directly called by the user.
##' 
##' 
##' @aliases acum adjust.rf.ril avoid.reverse codif.data comb comb.ger cr2pts
##' cr3pts Cindex diplo draw.order draw.rf.inter draw.try est.map.c perm.pars
##' perm.tot phases plotFunction.out rem.amb.ph return.geno ser.ord
##' print.bc.onemap print.compare print.f2.onemap print.order print.outcross
##' print.rf.3pts print.riself.onemap print.risib.onemap print.sequence
##' @author Gabriel Rodrigues Alves Margarido and Marcelo Mollinari
##' @keywords internal
NULL





##' Software for constructing genetic maps
##' 
##' In its earlier version, the software implemented the methodology proposed
##' by \cite{Wu et al.} (2002a), which uses the maximum likelihood approach to
##' estimate linkage and linkage phases for a mixed set of different marker
##' types, to building genetic maps in outcrossing species.  After, it was
##' modified to also using a Hidden Markov Model approach for constructing
##' multipoint maximum likelihood linkage maps (Wu et al. 2002b). It was then
##' applied in several studies, such as Garcia et al. (2006), Oliveira et al.
##' (2007) and Oliveira et al. (2008). Nowadays, the latest versions (2.0-3)
##' was fully modified to also handle with backcrosses, F_2 and recombinant
##' inbred lines (RIL) populations, allowing fully integration with software
##' for QTL mapping, such as R/qtl and QTL Cartographer. OneMap can read and
##' export files to this packages, and also from the widely used software
##' MAPMAKER.
##' 
##' \tabular{ll}{ Package: \tab onemap\cr Type: \tab Package\cr Version: \tab
##' 2.0-3\cr Date: \tab 2012-12-06\cr License: \tab GNU GENERAL PUBLIC LICENSE
##' (Version 3)\cr }
##' 
##' Usage of \pkg{onemap} is completely described in a tutorial distributed
##' with the package. You can look for it in directory \code{/doc} of the
##' package distribution.
##' 
##' The most important functions are: \itemize{ \item
##' \code{\link[onemap]{read.outcross}} for data importing.
##' 
##' \item \code{\link[onemap]{read.mapmaker}} for importing data from a
##' MAPMAKER raw file.
##' 
##' \item \code{\link[onemap]{rf.2pts}} to perform two-point analyses between
##' all pairs of markers.
##' 
##' \item \code{\link[onemap]{marker.type}} to check the segregation type of a
##' marker.
##' 
##' \item \code{\link[onemap]{make.seq}} to define a sequence of markers, which
##' are the input of most mapping functions.
##' 
##' \item \code{\link[onemap]{group}} to assign markers to linkage groups.
##' 
##' \item \code{\link[onemap]{compare}} to compare all possible orders of
##' markers in a sequence.
##' 
##' \item \code{\link[onemap]{try.seq}} to try a given marker in every position
##' of a framework of mapped markers.
##' 
##' \item \code{\link[onemap]{order.seq}} to automate the process of mapping a
##' sequence of markers, combining compare and try.seq functions.
##' 
##' \item \code{\link[onemap]{ripple.seq}} to check a set of mapped markers,
##' looking for (plausible) alternative orders.
##' 
##' \item \code{\link[onemap]{map}} to construct a map for a sequence in a
##' given order.  }
##' 
##' @name onemap-package
##' @aliases onemap-package onemap
##' @docType package
##' @note See the complete tutorial distributed along with this package for
##' complete examples (located in directory /doc of the package distribution).
##' @author Gabriel R A Margarido, \email{gramarga@@gmail.com}, Marcelo
##' Mollinari, \email{mmollina@@usp.br} and Antonio Augusto F Garcia,
##' \email{augusto.garcia@@usp.br}
##' @references Basten, C. J., Weir, B. S. and Zeng, Z.-B. (2005) \emph{QTL
##' Cartographer Version 1.17: A Reference Manual and Tutorial for QTL
##' Mapping}.
##' 
##' Broman, K. W., Wu, H., Churchill, G., Sen, S., Yandell, B. (2008)
##' \emph{qtl: Tools for analyzing QTL experiments} R package version 1.09-43
##' 
##' Buetow KH, Chakravarti A (1987). Multipoint gene mapping using seriation.
##' I. General methods. \emph{Am J Hum} Genet 41: 180-188.
##' 
##' Doerge, R. W. (1996) Constructing genetic maps by rapid chain delineation.
##' \emph{Journal of Quantitative Trait Loci} 2: 121-132.
##' 
##' Garcia, A. A. F., Kido, E. A., Meza, A. N., Souza, H. M. B., Pinto, L. R.,
##' Pastina, M. M., Leite, C. S., Silva, J. A. G., Ulian, E. C., Figueira, A.
##' V. O. and Souza, A. P. (2006) Development of an integrated genetic map of a
##' sugarcane (\emph{Saccharum} spp.) commercial cross, based on a
##' maximum-likelihood approach for estimation of linkage and linkage phases.
##' \emph{Theoretical and Applied Genetics} 112: 298-314.
##' 
##' Haldane, J. B. S. (1919) The combination of linkage values and the
##' calculation of distance between the loci of linked factors. \emph{Journal
##' of Genetics} 8: 299-309.
##' 
##' Jiang, C. and Zeng, Z.-B. (1997). Mapping quantitative trait loci with
##' dominant and missing markers in various crosses from two inbred lines.
##' \emph{Genetica} 101: 47-58.
##' 
##' Kosambi, D. D. (1944) The estimation of map distance from recombination
##' values. \emph{Annuaire of Eugenetics} 12: 172-175.
##' 
##' Lander, E. S. and Green, P. (1987). Construction of multilocus genetic
##' linkage maps in humans. \emph{Proc. Natl. Acad. Sci. USA} 84: 2363-2367.
##' 
##' Lander, E. S., Green, P., Abrahamson, J., Barlow, A., Daly, M. J., Lincoln,
##' S. E. and Newburg, L. (1987) MAPMAKER: An interactive computer package for
##' constructing primary genetic linkage maps of experimental and natural
##' populations. \emph{Genomics} 1: 174-181.
##' 
##' Lincoln, S. E., Daly, M. J. and Lander, E. S. (1993) Constructing genetic
##' linkage maps with MAPMAKER/EXP Version 3.0: a tutorial and reference
##' manual. \emph{A Whitehead Institute for Biomedical Research Technical
##' Report}.
##' 
##' Margarido, G. R. A., Souza, A.P. and Garcia, A. A. F. (2007) OneMap:
##' software for genetic mapping in outcrossing species. \emph{Hereditas} 144:
##' 78-79.
##' 
##' Mollinari, M., Margarido, G. R. A., Vencovsky, R. and Garcia, A. A. F.
##' (2009) Evaluation of algorithms used to order markers on genetic maps.
##' \emph{Heredity} 103: 494-502
##' 
##' Oliveira, K. M., Pinto, L. R., Marconi, T. G., Margarido, G. R. A.,
##' Pastina, M. M., Teixeira, L. H. M., Figueira, A. V. O., Ulian, E. C.,
##' Garcia, A. A. F. and Souza, A. P. (2007) Functional genetic linkage map
##' based on EST-markers for a sugarcane (\emph{Saccharum} spp.)  commercial
##' cross. \emph{Molecular Breeding} 20: 189-208.
##' 
##' Oliveira, E. J., Vieira, M. L. C., Garcia, A. A. F., Munhoz, C.
##' F.,Margarido, G. R.A., Consoli, L., Matta, F. P., Moraes, M. C., Zucchi, M.
##' I., and Fungaro,M. H. P. (2008) An Integrated Molecular Map of Yellow
##' Passion Fruit Based on Simultaneous Maximum-likelihood Estimation of
##' Linkage and Linkage Phases \emph{J. Amer. Soc. Hort. Sci.} 133: 35-41.
##' 
##' Tan, Y., Fu, Y. (2006). A novel method for estimating linkage maps.
##' \emph{Genetics} 173: 2383-2390.
##' 
##' Van Os H, Stam P, Visser RGF, Van Eck HJ (2005). RECORD: a novel method for
##' ordering loci on a genetic linkage map. \emph{Theor Appl Genet} 112: 30-40.
##' 
##' Wu, R., Ma, C.-X., Painter, I. and Zeng, Z.-B. (2002a) Simultaneous maximum
##' likelihood estimation of linkage and linkage phases in outcrossing species.
##' \emph{Theoretical Population Biology} 61: 349-363.
##' 
##' Wu, R., Ma, C.-X., Wu, S. S. and Zeng, Z.-B. (2002b). Linkage mapping of
##' sex-specific differences. \emph{Genetical Research} 79: 85-96
##' @keywords package
NULL



